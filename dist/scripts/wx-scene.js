!function(e){"use strict";function n(e,n,t){for(var i=n.split(" "),a=0,o=i.length;o>a;a++)e.addEventListener(i[a],t,!1)}function t(e,n,t){for(var i=n.split(" "),a=0,o=i.length;o>a;a++)e.removeEventListener(i[a],t)}function i(e){var n='<div class="play">播放</div><div class="pause">暂停</div>',t=document.createElement("div");t.className="player",t.innerHTML=n,document.body.appendChild(t);var i=t.children[0],a=t.children[1],s=document.createElement("audio"),r=!1;return document.body.appendChild(s),a.style.display="none",i.style.display="block",s.loop=!0,i.addEventListener("touchend",function(){o&&o.play()},!1),a.addEventListener("touchend",function(){o&&o.pause()},!1),{play:function(){r||(s.src=e,r=!0),s.play(),a.style.display="block",i.style.display="none"},pause:function(){s.pause(),a.style.display="none",i.style.display="block"}}}function a(e){var n="";n+="   <p>"+e.loading+"</p>",n+='   <div class="progress">',n+='       <div id="J_progress" class="inner"></div>',n+="   </div>";var t=document.createElement("div");t.className="loading_page",t.innerHTML=n,document.body.appendChild(t);var i,a=document.getElementById("J_progress"),o=function(){var e={};return{loadImages:function(n){for(var t=0,i=0,a=n.length;a>i;i++){var s=new Image;s.onload=function(){if("naturalHeight"in this){if(this.naturalHeight+this.naturalWidth===0)return void this.onerror()}else if(this.width+this.height===0)return void this.onerror();t++,e.progress&&e.progress.call(o,(t/n.length).toFixed(2)),t>=n.length&&e.imageLoaded&&e.imageLoaded.call(o)},s.onerror=function(){t++,t>=n.length&&e.imageLoaded&&e.imageLoaded.call(o)},s.src=n[i]}},on:function(n,t){e[n]=t}}}();o.on("imageLoaded",function(){t.style.display="none",i&&i.call()}),o.on("progress",function(e){a.style.maxWidth=100*e+"%"});for(var s=[],r=0,d=e.pages.length;d>r;r++){s.push(e.pages[r].bg);for(var l=0,c=e.pages[r].items.length;c>l;l++)s.push(e.pages[r].items[l].bg)}return o.loadImages(s),{onLoad:function(e){i=e}}}var o,s,r="pages.afterEnter",d=function(e){var n=this;return this.options=e,e.music&&(o=i(e.music)),e.loading?(s=a(e),void s.onLoad(function(){n.renderPages(e.pages),n.bindEvent()})):(this.renderPages(e.pages),void this.bindEvent())};d.prototype={renderPages:function(e){for(var n,t,i="",a=0,o=e.length;o>a;a++){n=e[a],i+='<div class="page" style="background-image:url('+n.bg+')">';for(var s=0,r=n.items.length;r>s;s++)t=n.items[s],i+='<div style="background-image:url('+t.bg+')"></div>';o-1>a&&(i+='<div class="icon icon_arrow"><i class="arrow"></i></div></div>'),i+="</div>"}var d=document.createElement("div");d.innerHTML=i,document.body.appendChild(d)},bindEvent:function(){function e(e){for(var i=0,a=o.length;a>i;i++)i!==d&&(o.item(i).className="page",o.item(i).style.display="none",o.item(e).style.zIndex=1);var s=function(){o.item(e).dispatchEvent(p),t(o.item(e),"webkitAnimationEnd animationend",s),o.item(e).style.zIndex=100};n(o.item(e),"webkitAnimationEnd animationend",s),o.item(e).style.display="block",o.item(e).className="page animate_enter",d=e}function i(){this.style.display="none",this.style.zIndex=1;for(var e=0,n=this.children.length;n>e;e++){var a=this.children[e];a.className.indexOf("icon")>-1||(a.className="",a.style.opacity=0)}t(this,"webkitTransitionEnd msTransitionEnd",i)}function a(t,a){var r=t;r.addEventListener("pages.toTop",function(){return a>=s-1?!1:(r.style.zIndex=100,r.className="page animate_swipe_top",n(r,"webkitTransitionEnd msTransitionEnd",i),e(a+1),void 0)},!1),r.addEventListener("pages.toBottom",function(){return 0>=a?!1:(r.style.zIndex=100,r.className="page animate_swipe_bottom",n(r,"webkitTransitionEnd msTransitionEnd",i),e(a-1),void 0)},!1);for(var d=o.item(a).children,l=0,c=d.length;c>l;l++)n(d[l],"animationstart webkitAnimationStart MSAnimationStart",function(){this.style.opacity=1})}var o=document.querySelectorAll(".page"),s=o.length,d=-1,l=document.createEvent("HTMLEvents");l.initEvent("pages.toTop",!1,!1);var c=document.createEvent("HTMLEvents");c.initEvent("pages.toBottom",!1,!1);var p=document.createEvent("HTMLEvents");p.initEvent(r,!1,!1);for(var g=0,m=o.length;m>g;g++)a.call(null,o.item(g),g);var u,v={};document.body.addEventListener("touchstart",function(e){"A"!==e.target.nodeName&&(v.pageX=e.changedTouches[0].pageX,v.pageY=e.changedTouches[0].pageY,e.preventDefault(),e.stopPropagation())},!1),document.body.addEventListener("touchend",function(e){"A"!==e.target.nodeName&&(u=e.changedTouches[0],v.pageY-u.pageY>60?o.item(d).dispatchEvent(l):u.pageY-v.pageY>60&&o.item(d).dispatchEvent(c),e.preventDefault(),e.stopPropagation())},!1),this.pages=o,this.bindPagesAnimation(),e(0)},bindPagesAnimation:function(){for(var e,n=this,t=0,i=this.pages.length;i>t;t++)e=n.pages[t],e.addEventListener(r,function(e){return function(){for(var t,i=this.children,a=n.options.pages[e],o=0,s=i.length;s>o;o++)t=i.item(o),t.className.indexOf("icon_arrow")>-1||(t.style.webkitAnimationDelay=a.items[o].delay?a.items[o].delay+"s":"0.2s",t.className="animate "+a.items[o].animate)}}(t),!1)}},e.WxScene=d}(this);